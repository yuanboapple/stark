{"remainingRequest":"/Users/yuanbo/Desktop/与燕/222/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/yuanbo/Desktop/与燕/222/src/views/settings/components/EditPassword.vue?vue&type=style&index=0&id=58aa1328&lang=less&scoped=true&","dependencies":[{"path":"/Users/yuanbo/Desktop/与燕/222/src/views/settings/components/EditPassword.vue","mtime":1560683835910},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_css-loader@1.0.1@css-loader/index.js","mtime":499162500000},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_vue-loader@15.7.0@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_less-loader@4.1.0@less-loader/dist/cjs.js","mtime":1559616265886},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#input-code{\n  margin-bottom: 1.6667rem;\n  .el-input{\n  width: 73%;\n  }\n  .code-btn{\n    margin-left: 5%;\n  }\n\n}   \n",{"version":3,"sources":["EditPassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"EditPassword.vue","sourceRoot":"src/views/settings/components","sourcesContent":["<template>\n    <div>\n        <div class=\"manageOption\">\n            <span class=\"manage-title\">为了您的账号安全，请妥善保管您的密码，点击前往修改。</span>\n            <el-button class=\"sys-Btn\"   type=\"primary\" @click=\"editDialogShow = true\">修改</el-button>\n        </div>\n      <el-dialog class=\"dialog\"\n           title=\"修改密码\"\n           :visible.sync=\"editDialogShow\"\n           width=\"30%\"\n           >\n                <div class=\"top-intro-area\">\n                 <span v-if=\"!isValidateAccount\" class=\"top-intro-text\">温馨提示：请牢记修改后的密码，避免遗忘。</span>\n                 <span v-else class=\"top-intro-text\">温馨提示：为了保证您的账户安全，修改密码前请先进行安全验证。</span>\n               </div>\n\n             <el-form :model=\"editform\" :rules=\"editRules\" ref=\"editform\" label-width=\"8rem\" size=\"medium\" label-position=\"right\" class=\"bindPhoneForm\">\n                <template v-if=\"isValidateAccount\">\n                   <el-form-item label=\"手机号：\" prop=\"telephone\">\n                     <el-input v-model=\"editform.telephone\"></el-input>\n                   </el-form-item>\n                   <el-form-item label=\"验证码：\" id=\"input-code\" prop=\"code\">\n                     <el-input v-model=\"editform.code\" ></el-input>\n                     <el-button v-if=\"!awardBtnRun\" class=\"sys-Btn code-btn\" @click=\"handleAwardCode\"   type=\"primary\" >验证码</el-button>\n                     <el-button v-else class=\"sys-Btn code-btn awardCode-Btn-run\"   type=\"primary\" >重新获取({{count}})s</el-button>\n                   </el-form-item>\n                </template>\n                <template v-else>\n                   <el-form-item label=\"新密码\" prop=\"newPassword\">\n                     <el-input v-model=\"editform.newPassword\"></el-input>\n                   </el-form-item>\n                   <el-form-item label=\"确认密码\" prop=\"resPassword\">\n                     <el-input v-model=\"editform.resPassword\"></el-input>  \n                   </el-form-item>\n                </template>             \n             </el-form>\n           <span slot=\"footer\" class=\"dialog-footer\">\n             <el-button v-if=\"!isValidateAccount\" class=\"sys-Btn\" type=\"primary\" @click=\"handleConfirmEdit\">确 定</el-button> \n             <el-button v-else class=\"sys-Btn\" type=\"primary\" @click=\"handleNextTep\">下一步</el-button> \n             <el-button @click=\"editDialogShow = false\">取 消</el-button>\n           </span>\n        </el-dialog>                 \n    </div>\n</template>\n<script>\nimport { async } from 'q';\nexport default {\n    data() {\n        return {\n            editDialogShow: false,\n            isValidateAccount: false,\n            awardBtnRun: false,\n            timer:null,\n            codeTxt:\"获取验证码\",\n            count: '',\n            editform: {\n                newPassword: \"\",\n                resPassword: \"\",\n                telephone: \"\",\n                code: \"\"\n            },\n            editRules:{\n              telephone: [\n                  { required: true, message: '请输入手机号', trigger: 'blur' },\n              ],\n              code: [\n                  { required: true, message: '请输入验证码', trigger: 'blur' },\n              ], \n                newPassword: [{ required: true, message: '请输入新密码', trigger: 'blur' }],\n                resPassword: [{ required: true, message: '请再次输入新密码', trigger: 'blur' }]\n            }            \n        }\n    },\n    methods: {\n        /*\n        **获取验证码事件\n        */\n         handleAwardCode(){\n            let _this = this\n            this.$refs.editform.validateField(\"telephone\", async function(valid) {\n                if(!valid)\n                {\n                    _this.awardBtnRun = true\n                    const Time_COUNT = 60;\n                    let resData = await _this.http.get(\"/platformUser/getRePasswordVerify\" ,{tel: _this.editform.telephone})\n                    if(resData)\n                    {\n                      _this.$message.success(resData.msg) \n                    }            \n                    if(!_this.timer)\n                    {\n                        _this.count = Time_COUNT;\n                        _this.timer = setInterval(()=>{\n                            if(_this.count>0 && _this.count <= Time_COUNT)\n                            {\n                                _this.count --;\n                            }\n                            else\n                            {\n                                _this.awardBtnRun = false\n                                clearInterval(this.timer)\n                                _this.timer = null\n                                _this.codeTxt = \"重新获取\";\n                            }\n                        }, 1000)\n                    }                  \n                }\n                \n            })\n        }, \n        /*\n        **点击下一步\n        */        \n        handleNextTep(){\n          this.$refs.editform.validateField(['telephone', 'code'], async (valid) =>{\n            \n            if(!valid){\n              let resData = await this.http.get('/platformUser/checkVerify', {code: this.editform.code})\n              if(resData.data.token){\n                localStorage.setItem('AVtoken', resData.data.token)\n                this.isValidateAccount = false\n                this.$refs.editform.clearValidate()\n              }\n            }\n          })\n        },\n        /*\n        **确认修改密码\n        */   \n        async handleConfirmEdit(){\n          let data = {\n            tel: this.editform.telephone,\n            password: this.editform.newPassword,\n            repassword: this.editform.resPassword,\n            code: this.editform.code,\n            __token__: localStorage.getItem(\"AVtoken\")\n          }\n          let resData = await this.http.post('/platformUser/resetPassword', data)\n          if(resData.code === 200)\n          {\n            this.$message.success(resData.msg)\n          }\n        }\n    },\n    created() {\n      this.isValidateAccount = true\n    },    \n}\n</script>\n<style lang=\"less\" scoped>\n#input-code{\n  margin-bottom: 1.6667rem;\n  .el-input{\n  width: 73%;\n  }\n  .code-btn{\n    margin-left: 5%;\n  }\n\n}   \n</style>\n"]}]}