{"remainingRequest":"/Users/yuanbo/Desktop/与燕/222/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/yuanbo/Desktop/与燕/222/src/views/business/components/ChannelList.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/yuanbo/Desktop/与燕/222/src/views/business/components/ChannelList.vue","mtime":1560753578291},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_css-loader@1.0.1@css-loader/index.js","mtime":499162500000},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_vue-loader@15.7.0@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_less-loader@4.1.0@less-loader/dist/cjs.js","mtime":1559616265886},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yuanbo/Desktop/与燕/222/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#chooseBusinessDia,#viewBusinessDia{\n  .el-dialog__body{\n    padding-bottom:20px;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    // min-height: 200px;\n    .el-table{\n      display: inline-block;\n    }\n    \n  }\n  .pagination{\n    display: block;\n  }\n  #searchBar{\n    display: flex;\n    flex-direction: row-reverse;\n    margin-bottom: 20px;\n    .searchTool{\n      margin-right: 20px;\n    }\n  }\n\n\n}\n\n#chooseQxbusi{\n  .el-form-item__content{\n    display: flex;\n    align-items: center;\n  .el-tag {\n    margin-right: 10px;\n  }\n  }\n}\n\n",{"version":3,"sources":["ChannelList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4ZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChannelList.vue","sourceRoot":"src/views/business/components","sourcesContent":["<template>\n    <div>\n        <div class=\"contain-footer-top\">\n          <div class=\"contain-footer-topl\">                    \n            <el-button class=\"sys-Btn\" @click=\"channelDialogVisible = true\" type=\"primary\">新增渠道商</el-button>\n          </div>\n          <div class=\"contain-footer-topr\"> \n            <el-input v-model=\"condition.keyword\" class=\"searchTool\">\n                  <i\n                   class=\"el-icon-search el-input__icon\"\n                   slot=\"suffix\"\n                   @click=\"handleConSearchClick\">\n                  </i>\n            </el-input>                                          \n          </div>                        \n        </div>\n        <div class=\"contain-footer-bottom\">\n            <el-table\n                :data=\"channelList\"\n                border\n                style=\"width: 100%\">\n                <el-table-column align=\"center\"\n                  type=\"index\"\n                  label=\"ID\"\n                  width=\"80\">\n                </el-table-column>  \n                <el-table-column\n                  prop=\"account\"\n                  label=\"币安账号\"\n                  min-width=\"140\"\n                  align=\"center\">                      \n                </el-table-column>\n                <el-table-column\n                  prop=\"name\"\n                  label=\"渠道商名称\"\n                  width=\"100\"\n                  align=\"center\">\n                </el-table-column>\n                <el-table-column\n                  prop=\"company\"\n                  label=\"用户类型\"\n                  align=\"center\"\n                  width=\"80\">\n                </el-table-column>\n                <el-table-column\n                  prop=\"registerTime\"\n                  label=\"创建时间\"\n                  align=\"center\"\n                  min-width=\"180\">\n                </el-table-column>                    \n                <el-table-column\n                  label=\"操作\"\n                  align=\"center\"\n                  min-width=\"220\">\n                  <template slot-scope=\"scope\">\n                      <el-button class=\"sys-text-Btn\" size=\"small\" @click=\"handleEditChannel(scope.row.id)\" type=\"text\">编辑</el-button>\n                      <el-button class=\"sys-text-Btn\" size=\"small\"  type=\"text\" @click=\"handleViewBusiness(scope.row.id)\">查看旗下商户</el-button>\n                      <el-button class=\"sys-text-Btn\" size=\"small\" @click=\"handleViewData(scope.row.account)\"  type=\"text\">数据统计</el-button>\n                      <el-button v-if=\"!scope.row.isFrozen\" @click=\"enableAccount(scope.row.id)\"   size=\"mini\" type=\"success\">启用</el-button>\n                      <el-button v-else @click=\"handleFrozenAccount(scope.row.id)\"  size=\"mini\" type=\"danger\">禁用账户</el-button>\n                  </template>\n                </el-table-column>\n                <el-table-column\n                  label=\"账号状态\"\n                  align=\"center\"\n                  width=\"150\">\n                  <template slot-scope=\"scope\">\n                      <span v-if=\"!scope.row.isFrozen\" class=\" activeBtn\" type=\"text\">激活</span>\n                      <span v-else type=\"text\" class=\"no-activeBtn\">未激活</span>\n                  </template>\n                </el-table-column>                                                                                                 \n            </el-table>            \n        </div>\n      <el-pagination\n          class=\"pagination\"\n          background\n          layout=\"prev, pager, next\"\n          :hide-on-single-page=\"total<=15\"\n          @current-change=\"handleCurrentchange\"\n          :current-page = \"condition.page\"\n          :page-size=\"15\"\n          :total=\"total\">\n      </el-pagination>\n      <div style=\"clear:both;\"></div> \n      <!-- 新增渠道商Dialog          -->\n       <el-dialog class=\"dialog\" id=\"addContraDialog\"\n           :title=\"isEdit?'修改渠道商':'新增渠道商'\"\n           :visible.sync=\"channelDialogVisible\"\n           width=\"35%\"\n           >\n             <el-form :model=\"channelForm\" :rules=\"channelRules\" ref=\"channelForm\" label-width=\"auto\" size=\"medium\" label-position=\"right\" class=\"demo-ruleForm\">\n               <el-form-item label=\"渠道商名称：\" prop=\"channelName\">\n                 <el-input  v-model=\"channelForm.channelName\"></el-input>  \n               </el-form-item>\n                <el-form-item label=\"账号（手机号）：\" prop=\"account\">\n                 <el-input  v-model=\"channelForm.account\"></el-input>  \n               </el-form-item>               \n                <el-form-item label=\"密码：\" prop=\"password\">\n                 <el-input  v-model=\"channelForm.password\"></el-input>  \n               </el-form-item>\n                <el-form-item id=\"chooseQxbusi\" :label=\"isEdit?'修改旗下商户':'选择旗下商户：'\" prop=\"goods\">\n                  <div class=\"tagInfos\" v-if=\"businessTags.length\">\n                    <el-tag\n                     :key=\"tag.id\"\n                     v-for=\"tag in businessTags\"\n                     closable\n                     :disable-transitions=\"false\"\n                     @close=\"handleClose(tag)\">\n                     {{tag.name}}\n                    </el-tag>\n                  </div>\n                  <el-button  class=\"sys-Btn\" size=\"mini\" @click=\"handlenBusinessDialogShow(businessTags)\">去选择</el-button>\n                </el-form-item>               \n                <el-form-item label=\"设置佣金：\"  prop=\"commission\">\n                 <el-input  class=\"commission-input\" v-model=\"channelForm.commission\"></el-input> %\n                 <div>\n                     <span class=\"commission-info\">商户收到的每一笔费用将抽成比例佣金返给渠道商币安账户，请谨慎操作</span>\n                 </div>                   \n               </el-form-item>               \n             </el-form>\n           <span slot=\"footer\" class=\"dialog-footer\">\n\n             <el-button v-if=\"!isEdit\" class=\"sys-Btn\" type=\"primary\" @click=\"handleAddChannel\">确 定</el-button> \n             <el-button v-else class=\"sys-Btn\" type=\"primary\" @click=\"handleConfirmEditChannel\">确定123</el-button>              \n             <el-button @click=\"channelDialogVisible = false\">取 消</el-button>\n           </span>   \n        </el-dialog>  \n           <!-- 选择商户模态框 -->\n         <el-dialog class=\"dialog\"\n           title=\"选择商户\"\n           :visible.sync=\"chooseBusinessDialogVisible\"\n           id=\"chooseBusinessDia\"\n           width=\"35%\"\n           >\n            <div id=\"searchBar\">\n             <div><el-input v-model=\"busiSearch\" class=\"searchTool\"></el-input>\n             <el-button class=\"sys-Btn\" @click=\"handleChooseBusiness\">搜索</el-button></div>\n           </div>\n           <template v-if=\"businessArr\">\n           <div>\n             <el-table  :data=\"businessArr\"  ref=\"businessArrTable\" border style=\"width:100%\">\n               <el-table-column type=\"selection\" label=\"选择\" align=\"center\" width=\"50\"></el-table-column>\n               <el-table-column type=\"index\" label=\"序号\" align=\"center\" min-width=\"50\"></el-table-column>\n               <el-table-column property=\"name\" align=\"center\" label=\"商户名称\" min-width=\"120\"></el-table-column>\n             </el-table>\n           </div>\n            <el-pagination\n                class=\"pagination\"\n                background\n                layout=\"prev, pager, next\"\n                :hide-on-single-page=\"total<=page\"\n                :total=\"total\"\n                :page-size.sync=\"page\"\n                >\n            </el-pagination>  \n           <span slot=\"footer\" class=\"dialog-footer\">\n             <el-button class=\"sys-Btn\" type=\"primary\" @click=\"handleConfireChoose\">确 定</el-button>               \n             <el-button @click=\"chooseBusinessDialogVisible = false\">取 消</el-button>\n           </span>\n           </template>\n\n        </el-dialog>\n           <!-- 选择旗下商户模态框 -->\n         <el-dialog class=\"dialog\"\n           title=\"旗下商户\"\n           id=\"viewBusinessDia\"\n           :visible.sync=\"viewBuisinessDialogShow\"\n           width=\"35%\"\n           >\n           <div>\n             <el-table    :data=\"inBusiness.data\"  ref=\"businessArrTable2\" border style=\"width:100%\">\n               <el-table-column type=\"index\" label=\"ID\" align=\"center\" min-width=\"50\"></el-table-column>\n               <el-table-column property=\"name\" align=\"center\" label=\"商户名称\" min-width=\"80\"></el-table-column>\n               <!-- <el-table-column property=\"account\" align=\"center\" label=\"币安账户\" min-width=\"80\"></el-table-column> -->\n               <el-table-column property=\"commission\" align=\"center\" label=\"佣金\" min-width=\"80\"></el-table-column>\n               <el-table-column property=\"createTime\" align=\"center\" label=\"创建时间\" min-width=\"100\"></el-table-column>\n             </el-table>\n           </div>\n            <el-pagination\n                class=\"pagination\"\n                background\n                layout=\"prev, pager, next\"\n                :hide-on-single-page=\"inBusiness.total<=inBusiness.per_page\"\n                :total=\"inBusiness.total\"\n                :page-size.sync=\"inBusiness.per_page\"\n                >\n            </el-pagination>  \n        </el-dialog>         \n \n    </div>\n</template>\n<script>\nimport { async } from 'q';\nexport default {\n    data() {\n        return {\n            channelDialogVisible: false,\n            viewBuisinessDialogShow: false,\n            chooseBusinessDialogVisible: false,\n            isEdit: false,\n            userState:'',\n            condition: {\n              keyword: '',\n              page: 1\n            },\n            busiSearch:'',\n            contractorSearch:'',\n            total: 0,\n            inBusiness:{ \n\n            },//旗下商户\n            businessIds: \"\",\n            businessTags: [],\n            businessArr: null, \n            channelList: [],           \n            channelForm: {\n                channelName: '',\n                account: '',\n                password: '',\n                commission:''\n            },\n            channelRules:{\n              channelName: [\n                  { required: true, message: '请输入账号', trigger: 'blur' },\n              ],\n              account: [\n                  { required: true, message: '请输入账户/手机号', trigger: 'blur' },\n              ],   \n              password:[\n                  { required: true, message: '请输入密码', trigger: 'blur' },                  \n              ],                          \n              goods:[\n                  { required: true, message: '请选择商品', trigger: 'blur' },                  \n              ],\n              commission:[\n                  { required: true, message: '请输入佣金', trigger: 'blur' },                  \n              ]                               \n            }                         \n        }\n    },\n    methods: {\n        /*\n        **处理搜索事件\n        */      \n        async handleConSearchClick(){\n          await this._getChannelList(this.condition)\n        },\n        handleViewData(account) {\n            this.$router.push({name: 'commiInbusiStatistic',query: {id: 28}})\n        },\n        /*\n        **处理选择商户搜索事件\n        */\n        async handleChooseBusiness() {\n          let businesses = await this._getBusinessListByTel(this.busiSearch)\n          if(businesses.data.length){\n            this.chooseBusinessDialogVisible = true\n            this.businessArr = businesses.data\n            this.total = businesses.total\n            this.page = businesses.per_page\n          }\n          \n        },\n        /*\n        **处理确认选择商户事件\n        */\n        handleConfireChoose(){\n          let selections = this.$refs.businessArrTable.selection;\n          if(selections.length){\n           this.businessTags = selections.map(s=> {return {id: s.id , name: s.name }})\n           this.chooseBusinessDialogVisible = false\n          }\n        },\n        /*\n        **处理去选择事件\n        */\n        async handlenBusinessDialogShow(tags) {\n          await this.handleChooseBusiness()\n          let ids = tags.map(v=> {return v.id})\n          for (const business of this.businessArr) {\n            if(ids.indexOf(business.id) >=0)\n            {\n              this.$refs.businessArrTable.toggleRowSelection(business)\n            }\n          }\n          this.chooseBusinessDialogVisible = true\n        },\n        /*\n        **网络请求获取商户列表\n        */\n        async _getBusinessListByTel(tel) {\n           let resData =  await this.http.get('/platform/merchantQuickSearch.api', {keyword: tel})\n           return resData;\n        },\n        /*\n        **确定添加渠道商事件\n        */\n        async handleAddChannel(){\n          let body = {\n            platformName: this.channelForm.channelName,\n            password: this.channelForm.password,\n            tel: this.channelForm.account,\n            platform: 3,\n            commission: this.channelForm.commission,\n            merchantId: this.businessIds\n          }\n          debugger\n          let resData = await this.http.post('/platform/createNewPlatform.api', body)\n          if(resData.code === 200)\n          {\n            this.$message.success(resData.msg)\n          }\n        },\n        /*\n        **确定修改渠道商事件\n        */\n        async handleConfirmEditChannel() {\n          let ids = this.businessTags.map(v=> {return v.id})\n          this.businessIds = ids.join(',')\n          let data = {\n            platformName: this.channelForm.account,\n            tel: this.channelForm.account,\n            password: this.channelForm.password,\n            commission: this.channelForm.commission,\n            merchantId: this.businessIds,\n            id: this.channelForm.id\n          }\n          let resData = await this.http.post('/platform/updateChannel', data)\n          if(resData.code === 200)\n          {\n            this.$message.success(resData.msg)\n            this.$refs.channelForm.resetFields()\n            this.channelDialogVisible = false;\n            this.isEdit = false;\n          }\n        },\n        /*\n         **启动平台账户事件\n         */\n        async enableAccount(id) {\n          let _id = id\n          let resData = await this.http.get('/platform/enablePlatform', {id: _id})\n          if(resData.code === 200){\n            this.$message.success(resData.msg)\n            await this._getChannelList(this.condition)\n          }\n        },        \n        /*\n        **网络获取渠道商列表事件\n        */\n       async _getChannelList(condition){\n         let _condition = condition\n         let resData = await this.http.get('/platform/channelLists', _condition)\n           this.channelList = resData.data\n           this.condition.page = resData.current_page\n           this.total = resData.total\n       },\n        /*\n         **处理冻结平台账户事件\n         */\n       async handleFrozenAccount(id){\n         let platformId = id\n         let resData = await this.http.get('/platform/frozenPlatform', {id: platformId})\n        },\n        /*\n        **处理查看旗下商户事件\n        */\n       async handleViewBusiness(id){\n         this.viewBuisinessDialogShow = true\n         let _id  = id;\n         let resData = await this.http.get(\"/platform/channelMerchant\",{id: _id})\n         this.inBusiness = resData\n       },\n        /*\n        **处理分页当前页改变事件\n        */\n       handleCurrentchange(val) {\n         this.condition.page = val\n         this._getChannelList(this.condition)\n       },    \n        /*\n        **处理编辑渠道商事件\n        */       \n       async handleEditChannel(id){\n         let _id = id;\n         let resData = await this.http.get(\"/platform/channelDetail.api\", {id: _id})\n         this.channelDialogVisible = true\n         this.isEdit = true\n         this.channelForm.id = _id\n         this.channelForm.account = resData.account\n         this.channelForm.channelName = resData.channel\n         this.channelForm.commission = resData.commission\n         this.businessTags = resData.merchant\n         let ids = resData.merchant.map(e => {\n              return  e.id\n            });\n         this.businessIds = ids.length>1?ids.join(','):ids.join('')\n       },\n        /*\n        **处理关闭tag事件\n        */       \n      async handleClose(tag){\n        this.businessTags.splice(this.businessTags.indexOf(tag), 1)\n       }\n       \n    },\n    async mounted() {\n      await this._getChannelList(this.condition);\n    },\n}\n</script>\n<style lang=\"less\">\n#chooseBusinessDia,#viewBusinessDia{\n  .el-dialog__body{\n    padding-bottom:20px;\n    text-align: center;\n    display: flex;\n    flex-direction: column;\n    // min-height: 200px;\n    .el-table{\n      display: inline-block;\n    }\n    \n  }\n  .pagination{\n    display: block;\n  }\n  #searchBar{\n    display: flex;\n    flex-direction: row-reverse;\n    margin-bottom: 20px;\n    .searchTool{\n      margin-right: 20px;\n    }\n  }\n\n\n}\n\n#chooseQxbusi{\n  .el-form-item__content{\n    display: flex;\n    align-items: center;\n  .el-tag {\n    margin-right: 10px;\n  }\n  }\n}\n\n</style>\n"]}]}