{"remainingRequest":"/Users/mac/Desktop/222/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/mac/Desktop/222/src/views/contractor/ContractorList.vue?vue&type=style&index=1&lang=less&","dependencies":[{"path":"/Users/mac/Desktop/222/src/views/contractor/ContractorList.vue","mtime":1561010254000},{"path":"/Users/mac/Desktop/222/node_modules/_css-loader@1.0.1@css-loader/index.js","mtime":499162500000},{"path":"/Users/mac/Desktop/222/node_modules/_vue-loader@15.7.0@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/mac/Desktop/222/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/mac/Desktop/222/node_modules/_less-loader@4.1.0@less-loader/dist/cjs.js","mtime":1559616265000},{"path":"/Users/mac/Desktop/222/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/222/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.el-radio__inner:hover{\n  border-color: #54B3D9\n}\n",{"version":3,"sources":["ContractorList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+gBA;AACA;AACA","file":"ContractorList.vue","sourceRoot":"src/views/contractor","sourcesContent":["<template>\n  <div>\n         <div class=\"contain-head\">\n            <div class=\"head-pre\"></div>\n            <span class=\"head-title\">承兑商列表</span>\n        </div>\n        <div class=\"contain-footer\">\n             <div class=\"contain-footer-top\">\n               <div class=\"contain-footer-topl\"> \n                  <el-button class=\"sys-Btn\" @click=\"addUser\" type=\"primary\">新增用户</el-button>                                                                          \n               </div>\n               <div class=\"contain-footer-topr\">\n                 <el-input v-model=\"conditon.keyword\" class=\"searchTool\">\n                       <i\n                        class=\"el-icon-search el-input__icon\"\n                        slot=\"suffix\"\n                        @click=\"handleSearchClick\">\n                       </i>\n                 </el-input>\n               </div>\n            </div>\n            <div class=\"contain-footer-bottom\">            \n                <el-table\n                    :data=\"contractorList\"\n                    border\n                    style=\"width: 100%\">\n                    <el-table-column align=\"center\"\n                      type=\"index\"\n                      label=\"ID\"\n                      width=\"50\">\n                    </el-table-column>  \n                    <el-table-column\n                      prop=\"account\"\n                      label=\"账号\"\n                      width=\"150\"\n                      align=\"center\">                      \n                    </el-table-column>\n                    <el-table-column\n                      prop=\"name\"\n                      label=\"承兑扇名称\"\n                      width=\"120\"\n                      align=\"center\">\n                    </el-table-column>\n                    <el-table-column\n                      prop=\"company\"\n                      label=\"用户类型\"\n                      align=\"center\"\n                      width=\"100\">\n                    </el-table-column>\n                    <el-table-column\n                      prop=\"industry\"\n                      label=\"行业\"\n                      align=\"center\"\n                      width=\"100\">\n                    </el-table-column>\n                    <el-table-column\n                      prop=\"registerTime\"\n                      label=\"注册时间\"\n                      align=\"center\"\n                      min-width=\"200\">\n                    </el-table-column>                                        \n                    <el-table-column\n                      label=\"保证金（余额）\"\n                      prop=\"bond\"\n                      align=\"center\"\n                      width=\"180\">\n                      <template slot-scope=\"scope\">\n                        {{scope.row.bond}}\n                        <el-button v-if=\"!scope.row.frozenBond\" class=\"smini-button\" type=\"primary\"   @click=\"frozenBond(scope.row.id)\" >冻结</el-button>\n                        <el-button class=\"smini-button\" v-else @click=\"thawBond(scope.row.id)\" type=\"success\" >解冻</el-button>\n                      </template>                                                                                                                               \n                    </el-table-column>\n                    <el-table-column\n                      prop=\"withdrawAmount\"\n                      label=\"可提现\"\n                      align=\"center\"\n                      min-width=\"160\">\n                      <template slot-scope=\"scope\">\n                        {{scope.row.withdrawAmount}}\n                        <el-button class=\"smini-button\" @click=\"setFrozenDialog = true;form.id = scope.row.id;\" type=\"primary\" v-if=\"!scope.row.frozenWithdraw\">冻结</el-button>\n                        <el-button class=\"smini-button\" @click=\"thawdrawAmount(scope.row.id, scope.row.thawWithdrawTime)\" type=\"success\" v-else>解冻</el-button>                      \n                        <div v-if=\"scope.row.frozenWithdraw\"><span class=\"frozenTime-time\">{{scope.row.thawWithdrawTime}} 解冻</span></div>\n                      </template>\n                    </el-table-column>\n                    <el-table-column\n                      label=\"操作\"\n                      align=\"center\"\n                      min-width=\"280\">\n                       <template slot-scope=\"scope\">\n                           <div>\n                              <el-button  class=\"sys-text-Btn\"   type=\"text\" @click=\"handleEditUser(scope.row.id)\" size=\"small\">编辑</el-button>\n                              <el-button class=\"sys-text-Btn\"  type=\"text\" size=\"small\" @click=\"commisionForm.account=scope.row.account;setCommisionDiaShow = true\">设置佣金</el-button>\n                              <el-button class=\"sys-text-Btn\"  type=\"text\"  size=\"small\" @click=\"handlePushOrderMang(scope.row.name)\"  >订单管理</el-button>\n                              <el-button id=\"disableAcount\" v-if=\"scope.row.isFrozen\" @click=\"handleEnableAccount(scope.row.id, scope.$index)\"   size=\"mini\" type=\"success\">启用</el-button>\n                              <el-button id=\"disableAcount\" v-else @click=\"handleFrozenAccount(scope.row.id, scope.$index)\"   size=\"mini\" type=\"danger\">禁用账户</el-button>                              \n                           </div>\n                       </template>\n                    </el-table-column>\n                    <el-table-column \n                      label=\"状态\"\n                      align=\"center\"\n                      width=\"100\">\n                      <template slot-scope=\"scope\">\n                         <span v-if=\"scope.row.isActive\" class=\"activeBtn\" type=\"text\">激活</span>\n                         <span v-else type=\"text\" clas=\"no-activeBtn\">未激活</span>          \n                      </template>\n                    </el-table-column>                     \n                </el-table>\n            </div>\n            <el-pagination\n                class=\"pagination\"\n                background\n                layout=\"prev, pager, next\"\n                :hide-on-single-page=\"!contractorList.length\"\n                @current-change=\"handleCurrentchange\"\n                :current-page = \"conditon.page\"\n                :page-size=\"15\"\n                :total=\"total\">\n            </el-pagination>\n            <div style=\"clear:both;\"></div>                \n        </div>    \n      <el-dialog \n           class=\"dialog\"\n           :title=\"isEdit?'修改用户':'新增用户'\"\n           :visible.sync=\"commisionDialogShow\"\n           width=\"25%\"\n           >\n        <div id=\"commission-dialog-wrap\">\n           <el-form :model=\"form\" :rules=\"rules\" ref=\"form\" label-width=\"auto\" size=\"medium\" label-position=\"right\" class=\"demo-ruleForm\">\n               <el-form-item label=\"账户\" prop=\"tel\">\n                 <el-input v-if=\"isEdit\" disabled v-model=\"form.tel\"></el-input>\n                 <el-input v-else v-model=\"form.tel\"></el-input>\n               </el-form-item>\n               <el-form-item label=\"承兑商名称\" prop=\"platformName\">\n                 <el-input v-model=\"form.platformName\"></el-input>\n               </el-form-item> \n               <el-form-item label=\"用户类型\" prop=\"type\">\n                    <el-radio-group v-model=\"form.type\">\n                      <el-radio :label=\"0\">单位</el-radio>\n                      <el-radio :label=\"1\">个人</el-radio>\n                    </el-radio-group>\n               </el-form-item> \n               <el-form-item label=\"行业\" prop=\"industry\">\n                    <el-select v-model=\"form.industry\" placeholder=\"去选择\">\n                      <el-option label=\"金融\" value=\"金融\"></el-option>\n                      <el-option label=\"其他\" value=\"其他\"></el-option>\n                    </el-select>\n               </el-form-item>\n               <template v-if=\"!isEdit\">\n                  <el-form-item label=\"密码\" prop=\"password\">\n                    <el-input v-model=\"form.password\" type=\"password\"></el-input>  \n                  </el-form-item> \n                  <el-form-item label=\"确认密码\" prop=\"repassword\">\n                    <el-input v-model=\"form.repassword\" type=\"password\"></el-input>  \n                  </el-form-item>\n               </template>                                                                     \n           </el-form>\n        </div>   \n           <span slot=\"footer\" class=\"dialog-footer\">\n             <el-button v-if=\"isEdit\" class=\"sys-Btn\" type=\"primary\" @click=\"handleConfirmEditUser\" >修改</el-button>\n             <el-button v-else class=\"sys-Btn\" type=\"primary\" @click=\"handleAddUser\" >确 定</el-button>               \n             <el-button @click=\"cancealCommisionDialog\">取 消</el-button>\n           </span>\n       </el-dialog>\n      <el-dialog class=\"dialog\"\n           id=\"setcommisionDialog\"\n           title=\"设置冻结\"\n           :visible.sync=\"setFrozenDialog\"\n           width=\"23%\"\n           >\n              <el-date-picker\n                v-model=\"frozenDate\"\n                type=\"datetime\"\n                placeholder=\"选择冻结时间\"\n                @change=\"frozendateChange\"\n                >\n              </el-date-picker>\n              <span slot=\"footer\" class=\"dialog-footer\">\n                <el-button class=\"sys-Btn\" type=\"primary\" @click=\"frozendrawAmount(form.id, dateString)\">确 定</el-button>               \n                <el-button @click=\"concrealfrozendate\">取 消</el-button>\n              </span>\n    </el-dialog>         \n      <el-dialog class=\"dialog\"\n           id=\"setcommisionDialog\"\n           title=\"设置佣金\"\n           :visible.sync=\"setCommisionDiaShow\"\n           width=\"23%\"\n           >\n             <el-form :model=\"commisionForm\" :rules=\"commisionRules\" ref=\"commisionRules\" label-width=\"auto\" size=\"medium\" label-position=\"right\" class=\"demo-ruleForm\">\n               <el-form-item label=\"确认用户名：\" prop=\"account\">\n                 <el-input disabled :placeholder=\"commisionForm.account\" ></el-input>\n               </el-form-item>\n               <el-form-item label=\"佣金比例：\" prop=\"rate\">\n                 <el-input v-model=\"commisionForm.rate\"></el-input>  \n               </el-form-item>              \n             </el-form>\n           <span slot=\"footer\" class=\"dialog-footer\">\n             <el-button class=\"sys-Btn\" type=\"primary\" @click=\"handleConfirmSetCommis\">确 定</el-button>               \n             <el-button @click=\"setCommisionDiaShow = false\">取 消</el-button>\n           </span>\n    </el-dialog>       \n  </div>\n</template>\n<script>\nimport { async } from 'q';\n  export default {\n      data() {\n        let accountValidate = (rule, value, callback) => {\n          if(value === ''){\n            callback(new Error('请输入用户名'))\n          }\n          else {\n            if(this.common.mobileReg.test(value)){\n              callback()\n            } else {\n              callback(new Error('请输入合法的手机号'))\n            }\n          }\n        }\n        let repasswordValidate = (rule, value, callback) => {\n          if(value === '') {\n            callback(new Error('请再次输入密码'))\n          } else {\n            if(value !== this.form.password) {\n              callback(new Error('两次输入的密码不一致'))\n            } else {\n              callback()\n            }\n          }\n        }\n          return {\n          conditon: {\n            keyword: '',\n            page: 1\n          },\n          isEdit: false,\n          contractorList:[],\n          commisionDialogShow: false,\n          setCommisionDiaShow: false,\n          setFrozenDialog: false,\n          total:0,\n          frozenDate:'',\n          dateString:'',\n          form: {\n            tel: '',\n            platformName: '',\n            type: 0,\n            industry: '',\n            password: '',\n            repassword: '',\n            id: null,\n          },\n          rules: {\n              tel: [\n                  { required: true, validator: accountValidate, trigger: 'blur' },\n              ],\n              platformName: [\n                  { required: true, message: '请输入承兑商名称', trigger: 'blur' },\n                  { min: 2, message: '名称不少于2位', trigger: 'blur'}\n              ], \n              type: [\n                { required: true, message: '请选择用户类型', trigger: 'change' },\n              ],\n              industry: [\n                { required: true, message: '请选择行业', trigger: 'change' },\n              ],  \n              password: [\n                { required: true, message: '请输入密码', trigger: 'blur' },\n                { min: 6, max: 20, message: \"密码长度不少于6且不大于20\", trigger: 'blur' },\n              ], \n              repassword: [\n                { required: true, validator: repasswordValidate, trigger: 'blur' },\n                { min: 6, max: 20, message: \"密码长度不少于6且不大于20\", trigger: 'blur' },\n              ],                                           \n          },\n            commisionForm: {\n                account: '',\n                rate: ''\n            },          \n            commisionRules: {\n              account: [\n                  { required: true, message: '请输入用户名', trigger: 'blur' },\n              ],\n              rate: [\n                  { required: true, message: '请输入佣金比例', trigger: 'blur' },\n              ],                   \n            },           \n          }\n      },\n      methods: {\n          addUser() {\n              this.commisionDialogShow = true\n          },\n          /*\n          **处理搜素事件\n          */\n          async handleSearchClick(){\n            await this._getContractorLst(this.conditon)\n          }\n          ,\n          /*\n          **处理新增用户事件\n          */\n          async handleAddUser() {\n            let body = this.form\n            body.platform = 1\n            let resData = await this.http.post(`${this.common.basePath}/platform/createNewPlatform.api`,body)\n            if(resData.code === 200)\n            {\n              this.$message.success(\"注册成功\")\n              this.commisionDialogShow = false\n              this._getContractorLst(this.conditon)\n            }\n          },\n          /*\n          **网络获取承兑商列表\n          */\n         async _getContractorLst(conditon) {\n           let _conditon = conditon\n           let resData = await this.http.get('/platform/acceptanceLists', conditon)\n           if(resData.code === 200){\n              this.contractorList = resData.data.data\n              this.conditon.page = resData.data.current_page\n              this.total = resData.data.total             \n           }\n\n           \n         },\n        /*\n         **处理冻结平台账户事件\n         */\n       async handleFrozenAccount(id, index){\n         let _index = index\n         let platformId = id\n         let resData = await this.http.get('/platform/frozenPlatform', {id: platformId})\n         if(resData.code===200)\n         {\n           this.$message.success(\"禁用成功\")\n           this.contractorList[_index].isFrozen = true\n           this.contractorList[_index].isActive = false\n         }\n        },\n        /*\n         **处理启动平台账户事件\n         */\n       async handleEnableAccount(id, index){\n         let _index = index\n         let platformId = id\n         let resData = await this.http.get('/platform/enablePlatform', {id: platformId})\n         if(resData.code===200)\n         {\n           this.$message.success(resData.msg)\n           this.contractorList[_index].isFrozen = false\n           this.contractorList[_index].isActive = true\n         }\n        },        \n        /*\n        **处理分页当前页改变事件\n        */\n       handleCurrentchange(val) {\n         this.conditon.page = val\n         this._getContractorLst(this.conditon)\n       },\n       /*\n       **处理确定设置佣金事件\n       */\n       async handleConfirmSetCommis(){\n         let param = {\n           type: 1,\n           tel: this.commisionForm.account,\n           proportion: this.commisionForm.rate\n         }\n         let resData = await this.http.get('/platform/setAcceptanceComsion', param)\n         if(resData.code == 200)\n         {\n           this.$message.success(resData.msg)\n         }\n       },\n       /*\n       **修改用户\n       */      \n       async handleEditUser(id) {\n         let _id = id\n         this.isEdit = true\n         this.commisionDialogShow = true\n         let resData = await this.http.get('/platform/acceptanceDetail', {id: _id})\n         this.form.tel = resData.tel\n         this.form.platformName = resData.platformName\n         this.form.industry = resData.industry\n         this.form.type = resData.company\n         this.form.id = _id\n       },\n       /*\n       **确认修改用户\n       */ \n       async handleConfirmEditUser() {\n         let data = {\n           id: this.form.id,\n           tel: this.form.tel,\n           platformName: this.form.platformName,\n           company: this.form.type,\n           industry: this.form.industry,\n           password: this.form.password,\n           repassword: this.form.repassword\n         }\n         let resData = await this.http.post('/platform/editAcceptance', data)\n         if(resData.code === 200){\n           this.$message.success(resData.msg)\n           this.commisionDialogShow = false\n           await this._getContractorLst(this.conditon)\n         }\n       },\n       /*\n       **取消修改/增加用户\n       */ \n       cancealCommisionDialog() {\n         this.commisionDialogShow = false\n        this.$refs.form.resetFields()\n       },\n       /*\n       **承兑冻结保证金\n       */\n       async frozenBond(id){\n         let _id = id\n         let resData = await this.http.get('/platform/frozenBond', {id: _id})\n         if(resData.code === 200){\n           this.$message.success(resData.msg)\n           this._getContractorLst(this.conditon)\n         }\n       },\n       /*\n       **承兑解冻保证金\n       */\n       async thawBond(id){\n         let _id = id\n         let resData = await this.http.get('/platform/thawBond', {id: _id})\n         if(resData.code === 200){\n           this.$message.success(resData.msg)\n           this._getContractorLst(this.conditon)\n         } \n       },\n       /*\n       **冻结可提现\n       */\n       async frozendrawAmount(id, time){\n         let _id = id\n         let _time = time\n         let resData = await this.http.get('/platform/frozenCashBalance', {id: _id, drawTime: _time})\n         if(resData.code === 200){\n           this.$message.success(resData.msg)\n            await this._getContractorLst(this.conditon)\n           this.setFrozenDialog = false\n         }\n       },\n       /*\n       **解冻可提现\n       */\n      async thawdrawAmount(id, time){\n        let _id = id\n        let _time = time\n        let resData = await this.http.get('/platform/drawCashBalance', {id: _id, drawTime: _time})\n        if(resData.code === 200){\n          this.$message.success(resData.msg)\n          await this._getContractorLst(this.conditon)\n          \n        }\n      },\n      /*\n      **确认选择的时间\n      */\n     frozendateChange(value){\n       let currentTimeStamp = (new Date()).getTime()\n       if(value.getTime() < currentTimeStamp)\n       {\n         this.$message.error(\"冻结不得早于当前时间\")\n         this.frozenDate = ''\n         this.dateString = ''\n         this.setFrozenDialog = false\n       }\n       else{\n         this.dateString = this.common.formatDate(value)\n       }\n     },\n      /*\n      **取消设置冻结\n      */\n     concrealfrozendate(){\n          this.frozenDate = ''\n          this.dateString = ''\n          this.setFrozenDialog = false\n     },\n     /*\n     **跳转订单管理\n     */\n     handlePushOrderMang(name){\n       let _name = name\n       this.$router.push({name: 'orderManage', query:{searchType: 2, keyword: _name}})\n     }\n      },\n      async mounted() {\n        await this._getContractorLst(this.conditon)\n      },\n  }\n</script>\n<style lang=\"less\" scoped>\n.contain-footer-topr{\n    .searchTool{\n        margin-right: 0;\n    }\n}\n .contain-head{\n    margin-bottom: 2vh;\n }\n #disableAcount{\n   margin-left: 10px;\n }\n .state-active{\n   color: #6BCC03;\n }\n .state{\n   color: #f00;\n }\n .frozenTime-time{\n   color: #F56C6C\n }\n</style>\n<style lang=\"less\">\n.el-radio__inner:hover{\n  border-color: #54B3D9\n}\n</style>\n\n"]}]}